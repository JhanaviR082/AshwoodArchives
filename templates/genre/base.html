<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>⋆˚꩜｡Ashwood Archives｡꩜˚⋆</title>
    {% load static %}
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Petit+Formal+Script&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    
    <!-- ALL STYLES MOVED HERE -->
    <style>
        .navbar-brand-center {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Great Vibes', cursive;
            font-size: 48px;
            color: #e6c88c !important;
            text-shadow: 
                2px 2px 4px rgba(58, 0, 0, 0.8),
                0 0 15px rgba(230, 200, 140, 0.8),
                0 0 30px rgba(179, 149, 89, 0.6);
            letter-spacing: 2px;
            background: 
                linear-gradient(to right, 
                    #f5e6b8, 
                    #e6c88c, 
                    #d4a85a,
                    #e6c88c,
                    #f5e6b8);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            padding-top: 0;
            line-height: 1;
            margin: 0;
            text-decoration: none !important;
            filter: sepia(15%) contrast(120%) brightness(105%);
            animation: inkFlow 8s infinite alternate;
        }

        @keyframes inkFlow {
            0% {
                background-position: 0% 50%;
                text-shadow: 
                    2px 2px 4px rgba(58, 0, 0, 0.8),
                    0 0 15px rgba(230, 200, 140, 0.8),
                    0 0 25px rgba(179, 149, 89, 0.6);
            }
            100% {
                background-position: 100% 50%;
                text-shadow: 
                    2px 2px 6px rgba(58, 0, 0, 0.9),
                    0 0 20px rgba(230, 200, 140, 0.9),
                    0 0 35px rgba(179, 149, 89, 0.7);
            }
        }

        .navbar-header {
            position: relative;
            height: 80px;
            width: 100%;
        }

        .navbar {
            min-height: 80px !important;
        }

        .navbar-toggle {
            margin-top: 10px !important;
            margin-bottom: 10px !important;
        }

        .top-right-nav {
  position: absolute;
  top: 50%;
  right: 20px;
  transform: translateY(-50%);
  display: flex;
  gap: 15px;
  align-items: center;
  font-family: 'Cinzel Decorative', serif;
  font-size: 1rem;
  color: #ffdd99;
  z-index: 1000; /* ensures it stays above scroll toggle */
}

        
        #candles-container {
            position: fixed;
            top: 0;
            bottom: 0;
            width: 40px;
            pointer-events: none;
            z-index: 12050;
            user-select: none;
        }

        #candles-container .candle {
            position: fixed;
            width: 30px;
            height: 70px;
            cursor: pointer;
            pointer-events: auto;
            user-select: none;
            filter: drop-shadow(0 0 3px rgba(212, 168, 90, 0.7));
            transition: filter 0.3s ease;
        }

        #candles-container .candle .wax {
            position: absolute;
            bottom: 0;
            left: 8px;
            width: 14px;
            height: 50px;
            background: linear-gradient(to bottom, #f5e6b8, #d4a85a);
            border-radius: 7px 7px 3px 3px;
            box-shadow: inset 0 0 5px #c1a84e;
        }

        #candles-container .candle .wick {
            position: absolute;
            bottom: 50px;
            left: 14px;
            width: 2px;
            height: 10px;
            background: #3b2e1e;
            border-radius: 1px;
        }

        #candles-container .candle .flame {
            position: absolute;
            bottom: 60px;
            left: 10px;
            width: 10px;
            height: 20px;
            background: radial-gradient(ellipse at center, #f9e45a 0%, #ffcc00 60%, transparent 80%);
            border-radius: 50% 50% 50% 50% / 100% 100% 50% 50%;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        #candles-container .candle.lit .flame {
            opacity: 1;
            animation: flicker 1.5s infinite;
        }

        @keyframes flicker {
            0%, 100% { transform: scale(1) translateY(0); opacity: 1; }
            50% { transform: scale(1.1) translateY(-3px); opacity: 0.8; }
        }

        #candles-container .candle .glow {
            position: absolute;
            bottom: 70px;
            left: 5px;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, rgba(230,200,140,0.8) 0%, transparent 80%);
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        #candles-container .candle.lit .glow {
            opacity: 1;
        }
        
        .spider-web {
            position: fixed;
            width: 150px;
            height: 150px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50 0v20M50 80v20M0 50h20M80 50h20M15 15l10 10M75 15l-10 10M15 75l10-10M75 75l-10-10" stroke="%23d4a85a" stroke-width="0.5" fill="none"/><circle cx="50" cy="50" r="5" fill="%23d4a85a" opacity="0.7"/><path d="M50 50Q30 30 20 50T50 80T80 50T50 20Z" stroke="%23d4a85a" stroke-width="0.3" fill="none" stroke-dasharray="2,2"/></svg>');
            background-repeat: no-repeat;
            opacity: 0.15;
            z-index: 999;
            pointer-events: none;
            animation: sway 15s infinite alternate ease-in-out;
            filter: drop-shadow(0 0 2px rgba(212, 168, 90, 0.5));
        }
        
        .top-left { top: 20px; left: 20px; transform-origin: 0% 0%; }
        .top-right { top: 20px; right: 20px; transform-origin: 100% 0%; }
        .bottom-left { bottom: 20px; left: 20px; transform-origin: 0% 100%; }
        
        @keyframes sway {
            0% { transform: rotate(0deg) scale(0.95); }
            50% { transform: rotate(3deg) scale(1.05); }
            100% { transform: rotate(-2deg) scale(0.98); }
        }
        
        .greeting-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;
            opacity: 0;
            transition: opacity 1s ease;
            background: rgba(40, 0, 0, 0.9);
            border: 1px solid #d4a85a;
            padding: 20px 40px;
            border-radius: 5px;
            box-shadow: 0 0 20px rgba(212, 168, 90, 0.3);
            pointer-events: none;
        }
        
        .greeting-container.show {
            opacity: 1;
        }
        
        .greeting-text {
            font-family: 'Petit Formal Script', cursive;
            font-size: 24px;
            color: #e6c88c;
        }
        
        .greeting-user {
            font-family: 'Great Vibes', cursive;
            color: #f5e6b8;
        }

        /* ====== ADD THIS AT THE END OF YOUR STYLES ====== */
/* Celestial Ink Trails */
.ink-trail {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1000;
}

.ink-path {
    position: absolute;
    background: linear-gradient(90deg, #3a0000, #e6c88c, #3a0000);
    box-shadow: 0 0 10px #e6c88c, 0 0 20px #d4a85a;
    opacity: 0;
    animation: inkAppear 2s forwards;
}

@keyframes inkAppear {
    0% { opacity: 0; transform: scale(0.5) var(--transform); }
    100% { opacity: 0.8; transform: scale(1) var(--transform); }
}

.ink-path::before, .ink-path::after {
    content: '';
    position: absolute;
    width: 8px;
    height: 8px;
    background: #e6c88c;
    border-radius: 50%;
    box-shadow: 0 0 5px #ffdd99;
}

.ink-path::before {
    top: -3px;
    left: -3px;
}

.ink-path::after {
    bottom: -3px;
    right: -3px;
}

.fade {
    animation: fadeOut 2s forwards;
}

@keyframes fadeOut {
    to { opacity: 0; }
}
/* ====== END OF CSS ADDITION ====== */

/* Enhanced flame animation */
.candle.lit .flame {
    animation: 
        flicker 1.5s infinite,
        zodiac-pulse 2s infinite alternate;
}

@keyframes zodiac-pulse {
    0% { opacity: 0.9; }
    100% { opacity: 1; }
}
.smoke {
    position: absolute;
    top: -20px;
    left: 50%;
    font-size: 24px;
    opacity: 1.0;
    z-index: 1000;
    pointer-events: none;
    text-shadow: 0 0 5px currentColor;
    transform: translateX(-50%);
    transition: all 1.5s cubic-bezier(0.2,0.8,0.3,1);
    animation: float-up 4s ease-out forwards;
}

@keyframes float-up {
    0% { transform: translateX(-50%) translateY(0); opacity: 1; }
    100% { transform: translateX(-50%) translateY(-100px); opacity: 0; }
}
/* Sidebar base */
.gothic-sidebar {
  position: fixed;
  top: 0;
  left: -300px;
  width: 260px;
  height: 100vh;
  background-color: rgba(25, 15, 10, 0.95);
  border-right: 1px solid #ffdd99;
  z-index: 1000;
  padding: 20px;
  transition: left 0.3s ease-in-out;
  font-family: 'Cinzel Decorative', serif;
  color: #ffdd99;
}

/* Show sidebar when active */
.gothic-sidebar.active {
  left: 0;
}

/* Sidebar toggle button */
.scroll-icon-btn {
  position: fixed;
  top: 15px;
  left: 15px;
  z-index: 1100;
  background-color: #2b1b10;
  border: 1px solid #ffdd99;
  color: #ffdd99;
  font-size: 1.4rem;
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
  font-family: 'Cinzel Decorative', serif;
}

/* Sidebar content layout */
.sidebar-content select,
.sidebar-content span,
.sidebar-content form,
.sidebar-content button {
  display: block;
  width: 100%;
  margin-bottom: 15px;
  margin-top: 60px; /* enough space below scroll button */
  padding: 10px 20px;
}

.gothic-search-form-sidebar input {
  width: 80%;
  padding: 6px;
  background-color: #1a0f08;
  border: 1px solid #ffdd99;
  color: #ffdd99;
}
.gothic-search-form-sidebar button {
  padding: 4px 8px;
  margin-top: 6px;
  background-color: #3e1e0d;
  color: #ffdd99;
  border: 1px solid #ffdd99;
}

/* keeps the Home link clear of the 📜 button */
.gothic-nav-left {
    margin-left: 60px;   /* tweak if you move the scroll icon */
}



/* Ambient sound button */
.ambient-btn {
  background: none;
  border: none;
  color: #ffdd99;
  font-size: 1.2rem;
  cursor: pointer;
  text-align: left;
}
body.sidebar-open .floating-candle.left {
  display: none !important;
}


    </style>
</head>
<body>
    <!-- Sidebar Toggle Button (Scroll Icon) -->
<button id="sidebarToggle" class="scroll-icon-btn" aria-label="Toggle Sidebar">
    📜
  </button>
  
  <!-- Sidebar -->
  <div id="gothicSidebar" class="gothic-sidebar">
    <div class="sidebar-content">
      <select id="zodiac-select">
        <option value="">Trace thy celestial</option>
        <option value="aries">Aries</option>
        <option value="taurus">Taurus</option>
        <option value="gemini">Gemini</option>
        <option value="cancer">Cancer</option>
        <option value="leo">Leo</option>
        <option value="virgo">Virgo</option>
        <option value="libra">Libra</option>
        <option value="scorpio">Scorpio</option>
        <option value="sagittarius">Sagittarius</option>
        <option value="capricorn">Capricorn</option>
        <option value="aquarius">Aquarius</option>
        <option value="pisces">Pisces</option>
      </select>
  
      <span id="gothic-clock-sidebar">00:00:00</span>
  
      <form action="{% url 'search' %}" method="get" class="gothic-search-form-sidebar">
        <input type="text" name="q" placeholder="Search the archive…">
        <button type="submit"><i class="glyphicon glyphicon-search"></i></button>
      </form>
  
      <button id="ambient-toggle" aria-label="Toggle Ambient Sound" class="ambient-btn">
        ♫ Whispers of Ashwood
      </button>
    </div>
    <audio id="ambient-audio" loop>
        <source src="{% static 'sounds/uplifting-pad-texture-113842.mp3' %}" type="audio/mpeg" />
    </audio>
</div>
  </div>
  
    <!-- HTML STRUCTURE MAINTAINED HERE -->
    <nav class="navbar navbar-inverse gothic-nav">
  <div class="container-fluid gothic-nav-row">
    <a class="navbar-brand-center gothic-brand">Ashwood Archives</a>
<!-- LEFT GROUP -->
<div class="gothic-nav-left">
    <a class="navbar-brand" href="/genre">Home</a>
  </div>
  
  <!-- RIGHT GROUP (TOP-RIGHT NAV) -->
  <div class="top-right-nav">
    {% if user.is_authenticated %}
      <span class="welcome-text"><i><b>WELCOME</b></i></span>
      <a href="{% url 'logout' %}">Logout</a>
    {% else %}
      <a href="{% url 'userform' %}">Register</a>
      <a href="{% url 'login' %}">Login</a>
    {% endif %}
  </div>
  
            </div>
          </nav>
    
    {% block content %}{% endblock %}

    <!-- Floating Candles -->
    <div id="candles-container"></div>

    <div class="spider-web top-left"></div>
    <div class="spider-web top-right"></div>
    <div class="spider-web bottom-left"></div>

    <div class="inkblot-reveal">
        <div class="inkblot" id="inkblot"></div>
        <p class="hidden-message">Click candles to light the archive...</p>
    </div>

    <div id="timeGreeting" class="greeting-container">
        <div class="greeting-content">
            <span class="greeting-text"></span>
            <span class="greeting-user"></span>
        </div>
    </div>

    <!-- Gothic Quote Banner -->
    <div id="gothic-quote" class="gothic-banner scroll-reveal"></div>

    <!-- Fog Overlay -->
    <div class="fog"></div>

    <!-- ALL SCRIPTS MOVED HERE -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        const lightSound = document.getElementById('light-sound');
        // Zodiac constellation path data
        function getZodiacConstellation(zodiac) {
            const constellations = {
                aries: [
                    "left:15%;top:20%;width:40px;height:2px;transform:rotate(45deg);",
                    "left:20%;top:25%;width:30px;height:2px;transform:rotate(-20deg);",
                    "left:25%;top:15%;width:25px;height:2px;transform:rotate(70deg);"
                ],
                taurus: [
                    "left:70%;top:30%;width:50px;height:2px;transform:rotate(15deg);",
                    "left:65%;top:35%;width:30px;height:2px;transform:rotate(-45deg);",
                    "left:75%;top:40%;width:20px;height:2px;transform:rotate(10deg);"
                ],
                gemini: [
                    "left:50%;top:30%;width:40px;height:2px;transform:rotate(0deg);",
                    "left:45%;top:40%;width:40px;height:2px;transform:rotate(0deg);",
                    "left:55%;top:40%;width:40px;height:2px;transform:rotate(0deg);"
                ],
                cancer: [
                    "left:30%;top:60%;width:60px;height:2px;border-radius:50%;transform:rotate(0deg);"
                ],
                leo: [
                    "left:60%;top:20%;width:50px;height:2px;transform:rotate(30deg);",
                    "left:65%;top:25%;width:30px;height:2px;transform:rotate(-30deg);"
                ],
                virgo: [
                    "left:40%;top:50%;width:60px;height:2px;transform:rotate(90deg);",
                    "left:40%;top:50%;width:30px;height:2px;transform:rotate(45deg);"
                ],
                libra: [
                    "left:50%;top:50%;width:60px;height:2px;transform:rotate(0deg);",
                    "left:50%;top:50%;width:30px;height:2px;transform:rotate(90deg);"
                ],
                scorpio: [
                    "left:50%;top:50%;width:30px;height:2px;transform:rotate(90deg);",
                    "left:50%;top:50%;width:30px;height:2px;transform:rotate(45deg);",
                    "left:55%;top:55%;width:20px;height:2px;transform:rotate(-45deg);"
                ],
                sagittarius: [
                    "left:50%;top:50%;width:60px;height:2px;transform:rotate(-60deg);",
                    "left:50%;top:50%;width:40px;height:2px;transform:rotate(60deg);"
                ],
                capricorn: [
                    "left:50%;top:50%;width:60px;height:2px;transform:rotate(0deg);",
                    "left:50%;top:50%;width:30px;height:2px;transform:rotate(45deg);"
                ],
                aquarius: [
                    "left:40%;top:50%;width:60px;height:2px;transform:rotate(0deg);",
                    "left:60%;top:50%;width:60px;height:2px;transform:rotate(0deg);"
                ],
                pisces: [
                    "left:30%;top:70%;width:60px;height:2px;transform:rotate(75deg);",
                    "left:40%;top:60%;width:50px;height:2px;transform:rotate(-30deg);"
                ]
            };
            return constellations[zodiac] || [];
        }
        
    
        // jQuery DOM ready
        $(function() {
            // Navbar link hover glow effect
            $('.navbar a').hover(function() {
                $(this).css('text-shadow', '0 0 8px #ffdd99');
            }, function() {
                $(this).css('text-shadow', 'none');
            });
    
            // Zodiac selection handler
            $('#zodiac-select').change(function() {
                const zodiac = $(this).val();
                if (!zodiac) return;
                
                // Clear previous ink
                $('.ink-trail').remove();
                
                // Create inkwell container
                const $inkwell = $('<div class="ink-trail"></div>').appendTo('body');
                
                // Generate constellation paths
                const paths = getZodiacConstellation(zodiac);
                paths.forEach((path, i) => {
                    setTimeout(() => {
                        $inkwell.append(`<div class="ink-path" style="${path}"></div>`);
                    }, i * 300);
                });
                
                // Auto-fade after display
                setTimeout(() => $inkwell.addClass('fade'), 5000);
            });
    
            // Fade in body on page load
            $("body").hide().fadeIn(1000);
    
            // Floating candles creation & interaction
            const positions = ['15%', '50%', '85%'];
    
            // Create candles on left and right
            positions.forEach(pos => {
                createCandle('left', pos);
                createCandle('right', pos);
            });
    
            function createCandle(side, topPos) {
                        const candle = $(`
                <div class="candle unlit">
                    <div class="wax"></div>
                    <div class="wick"></div>
                    <div class="flame" style="
                        background: radial-gradient(ellipse at center, 
                            #f9e45a 0%, 
                            #ffcc00 60%, 
                            transparent 80%);
                        box-shadow: 0 0 15px #ff8800;
                    "></div>
                    <div class="glow"></div>
                </div>
            `).css({
                [side]: '15px',
                top: topPos,
                transform: `rotate(${Math.random() * 6 - 3}deg)`
            }).appendTo('#candles-container');
    
                candle.click(function() {
                    if ($(this).hasClass('unlit')) {
                        lightCandle($(this));
                    } else {
                        extinguishCandle($(this));
                    }
                    updateTheme();
                });
            }
            const zodiacFlameColors = {
                aries: { inner: '#ff3300', outer: '#ff5e00' },
                taurus: { inner: '#00aa55', outer: '#00cc77' },
                gemini: { inner: '#aaaaaa', outer: '#dddddd' },
                cancer: { inner: '#ff66aa', outer: '#ff88cc' },
                leo: { inner: '#ff9900', outer: '#ffcc00' },
                virgo: { inner: '#88ff88', outer: '#bbffbb' },
                libra: { inner: '#ff77ff', outer: '#ff99ff' },
                scorpio: { inner: '#9900ff', outer: '#cc33ff' },
                sagittarius: { inner: '#ff5555', outer: '#ff7777' },
                capricorn: { inner: '#777777', outer: '#999999' },
                aquarius: { inner: '#00ffff', outer: '#66ffff' },
                pisces: { inner: '#3333ff', outer: '#6666ff' }
            };
    
            function lightCandle(candle) {
    // Play light sound
    const lightSound = document.getElementById('light-sound');
    if (lightSound) {
        lightSound.currentTime = 0;
        lightSound.play();
    }

    // Sparkle effect (keep existing)
    const sparkle = $('<div class="sparkle"></div>').appendTo(candle);
    sparkle.css({ left: '50%', top: '-20px' }).animate({ top: '-70px', opacity: 0 }, 800, function() {
        $(this).remove();
    });

    candle.removeClass('unlit').addClass('lit');

    // Zodiac flame colors
    const zodiac = $('#zodiac-select').val();
    if (zodiac && zodiacFlameColors[zodiac]) {
        candle.find('.flame').css({
            'background': `radial-gradient(ellipse at center, 
                ${zodiacFlameColors[zodiac].inner} 0%, 
                ${zodiacFlameColors[zodiac].outer} 60%, 
                transparent 80%)`,
            'box-shadow': `0 0 15px ${zodiacFlameColors[zodiac].inner}`
        });
    }

    // Flame pulse (keep existing)
    candle.find('.flame').css('transform', 'scale(1.2)');
    setTimeout(() => candle.find('.flame').css('transform', 'scale(1)'), 200);
}


            const zodiacSymbols = {
                aries: '♈', 
                taurus: '♉', 
                gemini: '♊',
                cancer: '♋', 
                leo: '♌', 
                virgo: '♍',
                libra: '♎', 
                scorpio: '♏', 
                sagittarius: '♐',
                capricorn: '♑', 
                aquarius: '♒', 
                pisces: '♓'
            };
    
            function extinguishCandle(candle) {
                // Play woosh sound
                const wooshSound = document.getElementById('woosh-sound');
                if (wooshSound) {
                    wooshSound.currentTime = 0;
                    wooshSound.play();
                }

                const zodiac = $('#zodiac-select').val();

                // Create colored smoke div
                const smoke = $('<div class="zodiac-smoke"></div>').appendTo(candle);

                // Set zodiac color if selected
                if (zodiac) {
                    smoke.addClass(zodiac + '-smoke');
                }

                // Animate
                smoke.css({
                    left: Math.random() * 20 - 10 + 'px'
                }).animate({
                    top: '-100px',
                    opacity: 0,
                    width: '40px',
                    height: '80px'
                }, 1500, function() {
                    $(this).remove();
                });

                candle.removeClass('lit').addClass('unlit');
            }

    
            function updateTheme() {
                const litCount = $('.candle.lit').length;
                const body = $('body');
    
                body.removeClass().addClass(
                    litCount === 0 ? 'pitch-black' :
                    litCount === 1 ? 'darkest' :
                    litCount === 2 ? 'darker' :
                    litCount === 3 ? 'dark' :
                    litCount === 4 ? 'medium' :
                    litCount === 5 ? 'light' : 'blood-red'
                );
            }
    
            // Initialize body theme
            $('body').addClass('pitch-black');
        });
    
        // Candle shadow effect based on mouse movement
        $(document).mousemove(function(e) {
            const x = e.pageX;
            const y = e.pageY;
    
            $('.candle').each(function() {
                const offset = $(this).offset();
                const centerX = offset.left + $(this).width() / 2;
                const centerY = offset.top + $(this).height() / 2;
    
                const deltaX = (centerX - x) / 20;
                const deltaY = (centerY - y) / 20;
    
                $(this).css('filter', `drop-shadow(${deltaX}px ${deltaY}px 4px rgba(0,0,0,0.5))`);
            });
        });
    
        // Timed greeting message on page load
        function showTimedGreeting() {
            if(localStorage.getItem('greetingShown')) return;
    
            const now = new Date();
            const hour = now.getHours();
            const user = "{% if user.is_authenticated %}{{ user.username }}{% endif %}";
            let greeting;
    
            if (hour < 5) {
                greeting = [
                    "The witching hour embraces you, ",
                    "Midnight oil burns bright for ",
                    "The archives whisper secrets to ",
                    "Phantom quills scribe tales for "
                ];
            } else if (hour < 12) {
                greeting = [
                    "The morning mist parts for ",
                    "Dawn's pale light greets ",
                    "A new day's parchment awaits ",
                    "The early scholar "
                ];
            } else if (hour < 17) {
                greeting = [
                    "The sun's zenith illuminates ",
                    "Daylight reveals truths to ",
                    "The afternoon watchman welcomes ",
                    "Quill and ink stand ready for "
                ];
            } else if (hour < 22) {
                greeting = [
                    "Twilight's veil descends for ",
                    "Candlelight flickers for ",
                    "The evening chronicler ",
                    "Dusk's quiet wisdom finds "
                ];
            } else {
                greeting = [
                    "The moon observes ",
                    "Midnight's ink flows for ",
                    "The night archivist ",
                    "Starlight guides "
                ];
            }
    
            if (hour === 0) {
                greeting = [
                    "The clock strikes twelve...",
                    "All spirits become readers tonight",
                    "The library's shadow self awakens",
                    "Books breathe in the midnight hour"
                ];
            }
    
            const randomGreeting = greeting[Math.floor(Math.random() * greeting.length)];
            const showUsername = user && !(hour === 0);
    
            const greetingEl = document.getElementById('timeGreeting');
            greetingEl.querySelector('.greeting-text').textContent = randomGreeting;
            greetingEl.querySelector('.greeting-user').textContent = showUsername ? user : '';
    
            greetingEl.classList.add('show');
            localStorage.setItem('greetingShown', 'true');
    
            setTimeout(() => greetingEl.classList.remove('show'), 5000);
        }
    
        setTimeout(showTimedGreeting, 1500);

        function updateClock() {
  const clock = document.getElementById('gothic-clock');
  if (!clock) return;

  const now = new Date();
  let h = now.getHours();
  let m = now.getMinutes();
  let s = now.getSeconds();

  // Convert to 12-hour format & add AM/PM if you want
  const ampm = h >= 12 ? 'PM' : 'AM';
  h = h % 12 || 12; // 0 means 12

  // Pad numbers with 0
  h = h < 10 ? '0' + h : h;
  m = m < 10 ? '0' + m : m;
  s = s < 10 ? '0' + s : s;

  clock.textContent = `${h}:${m}:${s} ${ampm}`;
}

// Update every second
setInterval(updateClock, 1000);
// Run immediately
updateClock();

    </script>
<audio autoplay loop id="ambient-sound">
    <source src="ambient.mp3" type="audio/mpeg" />
    Your browser does not support the audio element.
  </audio>
  <audio id="click-sound">
    <source src="{% static 'sounds/xbox-360-analogue-stick-click-97412.mp3' %}" type="audio/mpeg">
  </audio>
  
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const clickSound = document.getElementById('click-sound');
  
      document.addEventListener('click', (e) => {
        console.log("Click detected:", e.target); // Optional debug log
  
        if (clickSound) {
          clickSound.currentTime = 0; // Rewind to start
          clickSound.play().catch(err => {
            console.warn("Click sound failed:", err);
          });
        }
      });
    });
  </script>
  <audio id="light-sound">
    <source src="{% static 'sounds/068286_lighting-a-cigarettewav-47671.mp3' %}" type="audio/mpeg">
  </audio>
  <audio id="woosh-sound" preload="auto">
    <source src="{% static 'sounds/swoosh-5-329226.mp3' %}" type="audio/mpeg">
  </audio>  
  <script>
    const toggleBtn = document.getElementById('sidebarToggle');
    const sidebar = document.getElementById('gothicSidebar');
    toggleBtn.addEventListener('click', () => {
      sidebar.classList.toggle('active');
    });
  
    // Optional: move your existing clock to sidebar too
    function updateClock() {
      const now = new Date();
      const clockStr = now.toLocaleTimeString();
      document.getElementById('gothic-clock-sidebar').textContent = clockStr;
    }
    setInterval(updateClock, 1000);
    updateClock();
  </script>
  
</body>
</html>